"use strict";(self.webpackChunknav=self.webpackChunknav||[]).push([[67],{5016:(t,e,a)=>{a.d(e,{Z:()=>C});var s=a(2791),l=a(1564),o=a(528),n=(a(7562),a(7287),a(4867)),r=a(8039),c=a(8024),d=a(4649),i=a(2481),u=a(5960),p=a(3879);const m={lazyData:[],lastDoc:null,endOfCOllection:!1,fetchQuantity:50,totalColCount:0,progress:{success:null,error:null,isPending:null}},g=(t,e)=>{var a;switch(e.type){default:return t;case"PRE_FETCH_SETUP":return{...t,progress:{...t.progress,isPending:!0,error:""}};case"SUCCESS":return console.log("SUCCESS action.payload.data",null===(a=e.payload)||void 0===a?void 0:a.data),{...t,lazyData:e.payload.data,lastDoc:e.payload.lastDoc,progress:{...t.progress,success:!0,isPending:!1}};case"SET_COL_COUNT":return{...t,totalColCount:e.payload};case"ERROR":return{...t,progress:{...t.progress,success:!1,isPending:!1,error:"error fetching lazy load document(s) - ".concat(e.payload)}}}},y=t=>{const{ml1:e,ml2:a,ml3:l}=t,{state:o,dispatch:n}=(0,s.useContext)(p.k),[r,c]=(0,s.useReducer)(g,m),d=(0,s.useRef)(((t,a,s)=>{console.log("fetchData called");const l=(0,i.IO)((0,i.hJ)(u.db,e),(0,i.Xo)("metaData.updatedAtDatetime","desc"),(0,i.e0)(a||"0"),(0,i.b9)(s));return(0,i.cf)(l,(e=>{const a=[];e.forEach((t=>{const e={id:t.id,...t.data()};a.push(e)})),t({type:"SUCCESS",payload:{data:a,lastDoc:e.docs[e.docs.length-1]}}),n({type:"SET_FETCH",payload:!1})}))}));return(0,s.useEffect)((()=>{console.log("lazyState.lastDoc",r.lastDoc);const t=o.fetch&&!r.progress.isPending;console.log("canFetch",t);try{if(t){c({type:"PRE_FETCH_SETUP"});const t=d.current(c,r.lastDoc,r.fetchQuantity);return()=>t}}catch(e){c({type:"ERROR",payload:e.msg})}}),[o.fetch,r]),(0,s.useEffect)((()=>{(async()=>{const t=(0,i.hJ)(u.db,e),a=(await(0,i.Yp)(t)).data().count;c({type:"SET_COL_COUNT",payload:a})})()}),[e]),{fetchData:d,lazyState:r}};var f=a(184);const h=(t,e,a,s,l)=>"asts"===t||"trns"===t?null:(0,f.jsx)(n.Z,{nfd:s,fn:l}),C=t=>{console.log("Asts - props",t);const{ml1:e,tn:a,ml3:n,nfd:i,fn:u}=t,{state:m}=(0,s.useContext)(p.k);(t=>{const{dispatch:e}=(0,s.useContext)(p.k),{ml1:a,ml2:l,ml3:o}=t,{lazyState:n}=y({ml1:a,ml2:l,ml3:o});console.log("lazyState",n);const r=[...new Set(n.lazyData.map((t=>t.astData.astCartegory)))],c=[];r&&r.forEach((t=>{var e;const a=n.lazyData&&(null===(e=n.lazyData.filter((e=>{var a;return(null===e||void 0===e||null===(a=e.astData)||void 0===a?void 0:a.astCartegory)===t})))||void 0===e?void 0:e.length);c.push({name:t,quantity:a})})),(0,s.useEffect)((()=>{e({type:"ASTS_TOTALS",payload:{astsTotal:n.totalColCount,astsArray:c,asts:n.lazyData}})}),[n])})({ml1:e,ml2:a,ml3:n});const{getViewportDimensions:g}=(0,d.T)(),C=g(),{tableFields:D}=(0,c.I)({viewportDimesions:C,ml1:e,ml2:a,ml3:n}),S="undefined"===a?"":a;return(0,f.jsxs)("div",{className:"table ",children:[(0,f.jsxs)("div",{className:"table-header",children:[(0,f.jsx)("div",{className:"th-menu-levels",children:(0,f.jsx)("p",{children:"\n\t\t\t\t\t\t\t".concat(e?"".concat(l.QP.get(e)):"","\n\t\t\t\t\t\t\t").concat(S?"/ ".concat(l.QP.get(S),"s"):""," \n\t\t\t\t\t\t\t").concat(n?"/ ".concat(l.QP.get(n),"s"):"","\n\t\t\t\t\t\t")})}),(0,f.jsx)("div",{}),(0,f.jsx)("div",{})]}),(0,f.jsx)(r.Z,{rowData:m.asts,columnDefs:D,ml1:e,children:(0,f.jsx)(o.Z,{rowData:m.asts,columnDefs:D,ml1:e})}),h(e,0,0,i,u)]})}},8039:(t,e,a)=>{a.d(e,{Z:()=>l});a(2791);var s=a(184);const l=t=>(0,s.jsx)("div",{className:"table-wrapper",children:t.children})},7067:(t,e,a)=>{a.r(e),a.d(e,{default:()=>w});var s=a(2791),l=a(7689),o=(a(5016),a(6849)),n=a(1466),r=a(8341),c=(a(8360),a(1564)),d=(a(528),a(7562),a(7287),a(4867)),i=a(8039),u=a(8024),p=a(4649),m=a(8606),g=a(2481),y=a(5960);a(3879);const f={lazyData:[],lastDoc:null,endOfCOllection:!1,fetchQuantity:50,totalColCount:0,progress:{success:null,error:null,isPending:null}},h=(t,e)=>{switch(e.type){default:return t;case"PRE_FETCH_SETUP":return{...t,progress:{...t.progress,isPending:!0,error:""}};case"SUCCESS":return{...t,lazyData:e.payload.data,lastDoc:e.payload.lastDoc,progress:{...t.progress,success:!0,isPending:!1}};case"SET_COL_COUNT":return{...t,totalColCount:e.payload};case"ERROR":return{...t,progress:{...t.progress,success:!1,isPending:!1,error:"error fetching lazy load document(s) - ".concat(e.payload)}}}},C=t=>{const{ml1:e,ml2:a,ml3:l}=t,{state:o,dispatch:n}=(0,s.useContext)(m.R),[r,c]=(0,s.useReducer)(h,f),d=(0,s.useRef)(((t,a,s)=>{const l=(0,g.IO)((0,g.hJ)(y.db,e),(0,g.Xo)("metaData.updatedAtDatetime","desc"),(0,g.e0)(a||"0"),(0,g.b9)(s));return(0,g.cf)(l,(e=>{const a=[];e.forEach((t=>{const e={id:t.id,...t.data()};a.push(e)})),t({type:"SUCCESS",payload:{data:a,lastDoc:e.docs[e.docs.length-1]}}),n({type:"SET_FETCH",payload:!1})}))}));return(0,s.useEffect)((()=>{const t=o.fetch&&!r.progress.isPending;try{if(t){c({type:"PRE_FETCH_SETUP"});const t=d.current(c,r.lastDoc,r.fetchQuantity);return()=>t}}catch(e){c({type:"ERROR",payload:e.msg})}}),[o.fetch,r]),(0,s.useEffect)((()=>{(async()=>{const t=(0,g.hJ)(y.db,e),a=(await(0,g.Yp)(t)).data().count;c({type:"SET_COL_COUNT",payload:a})})()}),[e]),{fetchData:d,lazyState:r}};a(1350);var D=a(2798),S=(a(8807),a(1220),a(768)),v=a(7066),E=a(9108),x=a(184);S.O3h.registerModules([v.I]);const R=t=>(0,x.jsx)("div",{className:"ag-overlay-loading-center",style:{backgroundColor:"#e6ffe6",height:"70%"},children:(0,x.jsx)(E.Z,{color:"#ff99ff",loading:!0,cssOverride:{display:"block",margin:"0 auto",borderColor:"red"},size:200,"aria-label":"Loading Spinner","data-testid":"loader"})}),T=t=>{const{rowData:e,columnDefs:a,setSelectedRows:l,ml1:o}=t,{dispatch:n}=(0,s.useContext)(m.R);let r="";r="erfs"===o?"100%":"95%";const c=(0,s.useRef)(),d=(0,s.useMemo)((()=>({sortable:!0,filter:!0,resizable:!0,floatingFilter:!0,suppressMovable:!0})),[]),i=(0,s.useMemo)((()=>R),[]);return(0,x.jsx)("div",{style:{height:r},className:"ag-theme-alpine ireps-ag-table uplolad-table",children:(0,x.jsx)(D.s,{ref:c,rowData:e,columnDefs:a,defaultColDef:d,animateRows:!0,onSelectionChanged:t=>{l&&l(t.api.getSelectedRows())},tooltipShowDelay:0,pagination:!0,onGridReady:t=>{const{api:e,columnApi:a}=c.current;a.columnModel.viewportRight},noRowsOverlayComponent:i,onBodyScroll:t=>{const e=t.api.getVerticalPixelRange().bottom,a=t.api.getLastDisplayedRow()*t.api.getSizesForCurrentTheme().rowHeight;Math.abs(e-a)<100&&(console.log("close to bottm. Call next page"),n({type:"SET_FETCH",payload:!0}))}})})},b=(t,e,a,s,l)=>"asts"===t||"trns"===t?null:(0,x.jsx)(d.Z,{nfd:s,fn:l}),j=t=>{const{ml1:e,tn:a,ml3:l,nfd:o,fn:n}=t,{state:r}=(0,s.useContext)(m.R);(t=>{const{dispatch:e}=(0,s.useContext)(m.R),{ml1:a,ml2:l,ml3:o}=t,{lazyState:n}=C({ml1:a,ml2:l,ml3:o});(0,s.useEffect)((()=>{e({type:"TRNS_TOTALS",payload:{trnsTotal:n.totalColCount,trns:n.lazyData}})}),[n])})({ml1:e,ml2:a,ml3:l});const{getViewportDimensions:d}=(0,p.T)(),g=d(),{tableFields:y}=(0,u.I)({viewportDimesions:g,ml1:e,ml2:a,ml3:l}),f="undefined"===a?"":a;return(0,x.jsxs)("div",{className:"table ",children:[(0,x.jsxs)("div",{className:"table-header",children:[(0,x.jsx)("div",{className:"th-menu-levels",children:(0,x.jsx)("p",{children:"\n\t\t\t\t\t\t\t".concat(e?"".concat(c.QP.get(e)):"","\n\t\t\t\t\t\t\t").concat(f?"/ ".concat(c.QP.get(f),"s"):""," \n\t\t\t\t\t\t\t").concat(l?"/ ".concat(c.QP.get(l),"s"):"","\n\t\t\t\t\t\t")})}),(0,x.jsx)("div",{}),(0,x.jsx)("div",{})]}),(0,x.jsx)(i.Z,{rowData:r.trns,columnDefs:y,ml1:e,children:(0,x.jsx)(T,{rowData:r.trns,columnDefs:y,ml1:e})}),b(e,0,0,o,n)]})},w=()=>{const{ml2:t,ml3:e}=(0,l.UO)(),{user:a,isAuthReady:s}=(0,o.Z)();return s?a?(0,x.jsx)(j,{ml1:"trns",tn:t,ml3:e,fn:"TrnsForm"}):(0,x.jsx)(r.default,{}):(0,x.jsx)("div",{className:"users-list-loader",children:(0,x.jsx)(n.Z,{color:"orange",loading:!s,size:13,"aria-label":"Loading Spinner","data-testid":"loader"})})}},8360:()=>{},7287:()=>{}}]);
//# sourceMappingURL=67.6990e6be.chunk.js.map