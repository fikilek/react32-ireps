"use strict";(self.webpackChunknav=self.webpackChunknav||[]).push([[888],{8039:function(e,t,n){n.d(t,{Z:function(){return o}});n(2791);var a=n(184),o=function(e){return(0,a.jsx)("div",{className:"table-wrapper",children:e.children})}},4440:function(e,t,n){n.d(t,{Z:function(){return S}});var a=n(9439),o=n(4942),l=n(1413),s=n(2481),r=n(2791),i=(n(5960),n(6849)),d=n(2918),u=n(3341),c=n(2040),v=n(9256),p=n(9900),f=n.p+"static/media/lesediObedNkosiB.7c7f0d4c321de0e4e39d.geojson",m=n.p+"static/media/lesediObedNkosiC.9980411127fa176f8077.geojson",h=n(2116),b=n(5152),g=n(184),x=function(e){return e.children},N={"Obed Nkosi A":{lat:-26.541960658447646,lng:28.338629116440828},"Obed Nkosi B":{lat:-26.52888160075503,lng:28.3352936276032},"Obed Nkosi C":{lat:-26.532998883501552,lng:28.345134598723572}};function y(e){var t=(0,r.useContext)(b.X).area,n=(0,r.useRef)(),o=(0,d.Z)().openModal,l=(0,r.useState)(e.rowData),s=(0,a.Z)(l,2),i=s[0],u=s[1];(0,r.useEffect)((function(){u(e.rowData)}),[e.rowData]);var y=(0,h.Z)(),j=(y.setGeolocation,y.userGps,null===i||void 0===i?void 0:i.map((function(e){return{type:"Feature",properties:{cluster:!1,erfId:e.id,erf:e},geometry:{type:"Point",coordinates:[parseFloat(e.address.gps.longitude),parseFloat(e.address.gps.latitude)]}}}))),Z=(0,r.useState)([]),w=(0,a.Z)(Z,2),k=w[0],D=w[1],C=(0,r.useState)(10),E=(0,a.Z)(C,2),S=E[0],T=E[1],I=(0,v.Z)({points:j,bounds:k,zoom:S,options:{radius:75,maxZoom:20}}),G=I.clusters,O=I.supercluster,M=(0,r.useState)(""),A=(0,a.Z)(M,2),B=A[0],J=A[1],F=(0,r.useState)(""),R=(0,a.Z)(F,2),U=R[0],K=R[1],z=(0,r.useState)(""),W=(0,a.Z)(z,2),H=W[0],L=W[1];(0,r.useEffect)((function(){var e=null===i||void 0===i?void 0:i.filter((function(e){return e.erfNo.includes(U)}));L(e)}),[U]);var P=(null===U||void 0===U?void 0:U.length)>0?"show-erfs":"hide-erfs";(0,r.useEffect)((function(){if(B){var e,t,a,o,l,s,r=null===B||void 0===B||null===(e=B.address)||void 0===e||null===(t=e.gps)||void 0===t?void 0:t.latitude,i=null===B||void 0===B||null===(a=B.address)||void 0===a||null===(o=a.gps)||void 0===o?void 0:o.longitude;null===(l=n.current)||void 0===l||l.panTo({lat:r,lng:i}),null===(s=n.current)||void 0===s||s.setZoom(20)}}),[B]);(0,r.useEffect)((function(){var e,a,o,l,s,r,i,d,u,c,v,h,b,g;(null===(e=n.current)||void 0===e||null===(a=e.data)||void 0===a||a.forEach((function(e){var t;null===(t=n.current)||void 0===t||t.data.remove(e)})),"Obed Nkosi A"===(null===t||void 0===t?void 0:t.name))&&(null===(o=n.current)||void 0===o||null===(l=o.data)||void 0===l||l.loadGeoJson(p));"Obed Nkosi B"===(null===t||void 0===t?void 0:t.name)&&(null===(s=n.current)||void 0===s||null===(r=s.data)||void 0===r||r.loadGeoJson(f));"Obed Nkosi C"===(null===t||void 0===t?void 0:t.name)&&(null===(i=n.current)||void 0===i||null===(d=i.data)||void 0===d||d.loadGeoJson(m));"Obed Mthombeni Nkosi"===(null===t||void 0===t?void 0:t.name)&&(null===(u=n.current)||void 0===u||null===(c=u.data)||void 0===c||c.loadGeoJson(p),null===(v=n.current)||void 0===v||null===(h=v.data)||void 0===h||h.loadGeoJson(f),null===(b=n.current)||void 0===b||null===(g=b.data)||void 0===g||g.loadGeoJson(m))}),[t]);return(0,g.jsxs)("div",{className:"tabs-erfs-map",children:[(0,g.jsxs)("div",{className:"search-box",children:[(0,g.jsx)("input",{className:"erf-search",type:"text",placeholder:" enter erf no",onChange:function(e){return K(e.target.value)},value:U}),(0,g.jsx)("div",{className:"search-dropdown ".concat(P," "),children:H&&(null===H||void 0===H?void 0:H.map((function(e){var t,n,a,o,l=null===e||void 0===e?void 0:e.erfNo,s=null!==(t=e.propertyType)&&void 0!==t&&t.unitName?"| ".concat(null===(n=e.propertyType)||void 0===n?void 0:n.unitName):"",r=null!==(a=e.propertyType)&&void 0!==a&&a.unitNo?"| ".concat(null===(o=e.propertyType)||void 0===o?void 0:o.unitNo):"";return(0,g.jsx)("p",{onClick:function(){return function(e){J(e)}(e)},children:"".concat(l," ").concat(s," ").concat(r," ")},e.id)})))})]}),(0,g.jsx)(c.ZP,{bootstrapURLKeys:{key:"AIzaSyCj8IfmDEGxDWEXesDKBanx6HDp_1jxluI"},defaultCenter:{lat:-26.541960658447646,lng:28.338629116440828},center:N[t.name],defaultZoom:16,yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:function(e){var t,a,o=e.map;e.maps;n.current=o,null===(t=n.current)||void 0===t||null===(a=t.data)||void 0===a||a.setStyle({fillOpacity:0})},onChange:function(e){console.log("args",e);var t=e.zoom,n=e.bounds;T(t),D([n.nw.lng,n.se.lat,n.se.lng,n.nw.lat])},options:{mapTypeControl:!0,overviewMapControl:!0,rotateControl:!0,fullscreenControl:!1},children:G.map((function(e){var t,l,s,r,d,u,c,v,p,f,m=(0,a.Z)(e.geometry.coordinates,2),h=m[0],b=m[1],N=e.properties,y=N.cluster,Z=N.point_count,w=null===e||void 0===e||null===(t=e.properties)||void 0===t||null===(l=t.erf)||void 0===l?void 0:l.erfNo,k=null===e||void 0===e||null===(s=e.properties)||void 0===s||null===(r=s.erf)||void 0===r?void 0:r.id,D=(null===e||void 0===e||null===(d=e.properties)||void 0===d||null===(u=d.erf)||void 0===u||null===(c=u.asts)||void 0===c?void 0:c.length)>0?"has-asts":"";null===e||void 0===e||null===(v=e.properties)||void 0===v||null===(p=v.erf)||void 0===p||null===(f=p.asts)||void 0===f||f.length;return y?(0,g.jsx)(x,{lat:b,lng:h,children:(0,g.jsx)("div",{className:"cluster-marker",style:{width:"".concat(10+Z/j.length*20,"px"),height:"".concat(10+Z/j.length*20,"px")},onClick:function(){var t=Math.min(O.getClusterExpansionZoom(e.id),20);n.current.setZoom(t),n.current.panTo({lat:b,lng:h})},children:Z})},"".concat(e.id)):(0,g.jsx)(x,{lat:b,lng:h,children:(0,g.jsx)("button",{className:"erf-marker",onClick:function(){return function(e,t,a){var l;null===(l=n.current)||void 0===l||l.panTo({lat:t,lng:a});var s=i.find((function(t){return t.id===e}));s&&o({modalName:"tabsErfMapInfoWrapper",payload:s})}(k,b,h)},children:(0,g.jsx)("span",{className:"erf-no ".concat(D," ").concat(""),children:w})})},"".concat(e.properties.erfId))}))})]})}n(1350);var j=n(528),Z=n(4867),w=n(8039),k=function(e,t,n,a,o){return"asts"===e||"trns"===e||"erfs"===e?null:(0,g.jsx)(Z.Z,{nfd:a,fn:o})},D=function(e){var t=e.ml1,n=(e.tn,e.ml3,e.nfd),a=e.fn,o=e.rowData,l=e.columnDefs,s=e.setSelectedRows;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(w.Z,{rowData:o,columnDefs:l,ml1:t,children:(0,g.jsx)(j.Z,{rowData:o,columnDefs:l,setSelectedRows:s,ml1:t})}),k(t,0,0,n,a)]})},C=function(e,t,n){var a=[];return 0===e.lenght?a:e?(e.map((function(e){var r={};if("inspection"===t&&!(r=function(e){console.log("erf",e);var t=e.asts;if(console.log("asts",t),!t)return null;var n={};return t&&t.forEach((function(e){var t=e.astId;console.log("astId",t);var a=e.astData.astCartegory,s=u.m[a].inspection.trnData;if(e=(0,l.Z)((0,l.Z)({},e),{},{trnData:s}),a)if(n[a]){var r=n[a].some((function(e){return e.astId===t}));if(r){delete e.trnMetaData,delete e.astData,delete e.astId;var i=Object.entries(e)[0][0],d=n[a].findIndex((function(e){return e.astId===t}));n[a][d]=(0,l.Z)((0,l.Z)({},n[a][d]),{},(0,o.Z)({},i,e[i]))}else n[a].push(e)}else n[a]=[],delete e.trnMetaData,n[a].push(e)})),n}(e)))return null;if("installation"===t||"audit"===t||"inspection"===t){var i={metaData:{createdAtDatetime:s.EK.now(),createdByUser:n.displayName,createdByUserId:n.uid,updatedAtDatetime:s.EK.now(),updatedByUser:n.displayName,trnHistory:0,trnType:t,trnNo:"",trnState:"draft"},erfData:e,astData:r};return a.push(i)}})),a):void 0},E=[{key:"choose",value:"choose"},{key:"audit",value:"audit"},{key:"inspection",value:"inspection"}],S=function(e){var t=(0,r.useState)(""),n=(0,a.Z)(t,2),o=n[0],s=n[1],u=e.purpose,c=(0,r.useState)("tabs-map"),v=(0,a.Z)(c,2),p=v[0],f=v[1],m=(0,r.useState)([]),h=(0,a.Z)(m,2),b=h[0],x=h[1],N=(0,d.Z)().openModal,j=(0,i.Z)().user,Z=function(e){f(e.target.id)};return(0,r.useEffect)((function(){s("choose")}),[]),(0,g.jsxs)("div",{className:"tabs",children:[(0,g.jsxs)("div",{className:"tabs-header",children:[(0,g.jsx)("div",{className:"tab-title",children:(0,g.jsx)("p",{children:"Erfs Table"})}),"firestoreErfs"===u?(0,g.jsxs)("div",{className:"new-trn-div",children:[" ",(0,g.jsx)("button",{className:"new-trn new-trn-btn",disabled:"choose"===o||0===b.length,onClick:function(){if(o){var e=C(b,o,j);e.length>0&&(N({modalName:"tableTrnsFromErfs",payload:{newTrnsArray:e,trnType:o}}),s("choose"))}},children:"NT"})," ",(0,g.jsx)("select",{className:"new-trn new-trn-select",value:o,onChange:function(e){return s(e.target.value)},placeholder:"Store Name",children:E&&E.map((function(e){return(0,g.jsx)("option",{value:e.value,children:e.value},e.key)}))})]}):(0,g.jsx)("div",{}),(0,g.jsxs)("div",{className:"tabs-btns",children:[" ",(0,g.jsx)("div",{className:"tabs-header-table ".concat("tabs-table"===p?"tab-active":""," tabs-tab"),id:"tabs-table",onClick:Z,children:"Table"}),(0,g.jsx)("div",{className:"tabs-header-map ".concat("tabs-map"===p?"tab-active":""," tabs-tab"),id:"tabs-map",onClick:Z,children:"Map"})]})]}),(0,g.jsxs)("div",{className:"tabs-body",children:[(0,g.jsx)("div",{className:"tabs-body-content tabs-table ".concat("tabs-table"===p?"tabs-show":"tabs-hide","  "),id:"tabs-table",children:(0,g.jsx)(D,(0,l.Z)((0,l.Z)({},e),{},{setSelectedRows:x}))}),(0,g.jsx)("div",{className:"tabs-body-content tabs-map ".concat("tabs-map"===p?"tabs-show":"tabs-hide"," "),id:"tabs-map",children:(0,g.jsx)(y,(0,l.Z)({},e))}),(0,g.jsx)("div",{className:"tabs-body-content tabs-tree ".concat("tabs-tree"===p?"tabs-show":"tabs-hide"," "),id:"tabs-tree"})]})]})}},8360:function(){}}]);
//# sourceMappingURL=888.cab43dbb.chunk.js.map